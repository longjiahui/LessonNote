#include <stdio.h>
#include <stdlib.h>

#define N   24
#define  msleep(x)    (usleep(1000*x))

// 地图
static int map[N][N] = {
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,0,5,0,0,0,0,0,0,0,0,5,5,0,5,0,0,0,0,0,0,0,0,5,
  5,0,5,5,5,5,5,5,5,0,5,5,5,0,5,5,5,5,5,5,5,0,5,5,
  5,0,5,0,5,0,5,0,0,0,5,5,5,0,5,0,5,0,5,0,0,0,5,5,
  5,0,5,0,5,0,5,0,5,5,5,5,5,0,5,0,5,0,5,0,5,5,5,5,
  5,0,5,0,5,0,0,0,5,0,0,5,5,0,5,0,5,0,0,0,5,0,0,5,
  5,0,5,0,5,0,5,0,5,5,0,5,5,0,5,0,5,0,5,0,5,5,0,5,
  5,0,0,0,0,0,5,0,0,0,0,5,5,0,0,0,0,0,5,0,0,0,0,5,
  5,0,5,5,5,0,5,5,5,5,5,5,5,0,5,5,5,0,5,5,5,5,5,5,
  5,0,5,0,5,0,0,0,5,0,0,0,0,0,5,0,5,0,0,0,5,0,0,5,
  5,0,0,0,5,0,5,0,0,0,5,5,5,0,0,0,5,0,5,0,0,0,5,5,
  5,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,5,5,
  5,5,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,5,5,
  5,0,5,0,0,0,0,0,0,0,0,5,5,0,5,0,0,0,0,0,0,0,0,5,
  5,0,5,5,5,5,5,5,5,0,5,5,5,0,5,5,5,5,5,5,5,0,5,5,
  5,0,5,0,5,0,5,0,0,0,5,5,5,0,5,0,5,0,5,0,0,0,5,5,
  5,0,5,0,5,0,5,0,5,5,5,5,5,0,5,0,5,0,5,0,5,5,5,5,
  5,0,5,0,5,0,0,0,5,0,0,5,5,0,5,0,5,0,0,0,5,0,0,5,
  5,0,5,0,5,0,5,0,5,5,0,5,5,0,5,0,5,0,5,0,5,5,0,5,
  5,0,0,0,0,0,5,0,0,0,0,5,5,0,0,0,0,0,5,0,0,0,0,5,
  5,0,5,5,5,0,5,5,5,5,5,5,5,0,5,5,5,0,5,5,5,5,5,5,
  5,0,5,1,5,0,0,0,5,0,0,5,5,0,5,0,5,0,0,0,5,0,2,5,
  5,0,0,0,5,0,5,0,0,0,5,5,5,0,0,0,5,0,5,0,0,0,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
};
//左上右下
void show_mi(int *row , int *col);
int run_mi(int row , int col);

int main(void)
{
	int row , col ; 
	int  tmp1 , tmp2 ; 
	show_mi(&row , &col);
	

	run_mi(row , col);

	run(row , col);

    return 0;
}

void show_mi(int *row , int *col)
{
	system("clear");
	int i , j ; 
	for(i = 0 ; i < N ; i++)
	{
		for(j = 0 ; j < N ; j++)
		{
			if(map[i][j] == 5)
				printf("\033[%d;%dH\033[42m \033[0m" , i+5 , j+5);
			else if(map[i][j] == 1)
			{
				*row = i ; 
				*col = j ; 
				printf("\033[%d;%dH*" , i+5 , j+5);
			}
			else if(map[i][j] == 2)
				printf("\033[%d;%dHE" , i+5 , j+5);
			else if(map[i][j] == 3)
				printf("\033[%d;%dH\033[44m \033[0m" , i+5 , j+5);
			
		}
		putchar('\n');
	}
	fflush(stdout);
}

static int flag = 0 ; 

int run_mi(int row , int col)
{
	if((row == 21) && (col == 21))
	{
		flag = 1 ; 
		return 0; 
	}
	//msleep(100);
	map[row][col] = 4 ;
	//int tmp ;
	//show_mi(&tmp , &tmp);

	//左
	if((map[row][col-1] == 0) && (flag == 0))
		run_mi(row , col-1);

	//上
	if((map[row-1][col] == 0) && (flag == 0))
		run_mi(row-1 , col);

	//右
	if((map[row][col+1] == 0) && (flag == 0))
		run_mi(row , col + 1);

	//下
	if((map[row+1][col] == 0) && (flag == 0))
		run_mi(row + 1 , col);

	if(flag == 0)
	{
		map[row][col] = 0 ; 
	}

	return 0 ; 
}

int run(int row , int col)
{
	msleep(100);
	map[row][col] = 3 ;
	int tmp ;
	show_mi(&tmp , &tmp);

	//左
	if(map[row][col-1] == 4)
		run(row , col-1);

	//上
	if(map[row-1][col] == 4)
		run(row-1 , col);

	//右
	if(map[row][col+1] == 4)
		run(row , col + 1);

	//下
	if(map[row+1][col] == 4)
		run(row + 1 , col);

	return 0 ; 
}

